language: objective-c
osx_image: xcode10

install:
  - cd ./RxBus-Demo; pod install

matrix:
  include:
    - env: JOB="XCODE" DEST="OS=12.0,name=iPhone X" SCHEME="RxBus-Demo-iOS" ACTION="build-for-testing"
      osx_image: xcode10
    - env: JOB="XCODE" DEST="arch=x86_64" SCHEME="RxBus-Demo-macOS" ACTION="build-for-testing"
      osx_image: xcode10
    - env: JOB="XCODE" DEST="OS=11.0,name=Apple TV 4K" SCHEME="RxBus-Demo-tvOS" ACTION="build-for-testing"
      osx_image: xcode10

script:
  - set -o pipefail
  - xcodebuild "$ACTION" -workspace RxBus-Demo.xcodeproj/project.xcworkspace -scheme "$SCHEME" -destination "$DEST" -configuration Release ENABLE_TESTABILITY=YES | xcpretty

notifications:
  email: false
  slack:
    rooms:
      - 'rididev:KMm0EBQYY1ThicCJo0CwYb5U'
    on_success: change
